const xe=Symbol("Comlink.proxy"),lt=Symbol("Comlink.endpoint"),ut=Symbol("Comlink.releaseProxy"),pe=Symbol("Comlink.finalizer"),fe=Symbol("Comlink.thrown"),ct=r=>typeof r=="object"&&r!==null||typeof r=="function",kt={canHandle:r=>ct(r)&&r[xe],serialize(r){const{port1:o,port2:a}=new MessageChannel;return ge(r,o),[a,[a]]},deserialize(r){return r.start(),pt(r)}},Pt={canHandle:r=>ct(r)&&fe in r,serialize({value:r}){let o;return r instanceof Error?o={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:o={isError:!1,value:r},[o,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},Oe=new Map([["proxy",kt],["throw",Pt]]);function xt(r,o){for(const a of r)if(o===a||a==="*"||a instanceof RegExp&&a.test(o))return!0;return!1}function ge(r,o=globalThis,a=["*"]){o.addEventListener("message",function E(O){if(!O||!O.data)return;if(!xt(a,O.origin)){console.warn(`Invalid origin '${O.origin}' for comlink proxy`);return}const{id:j,type:A,path:i}=Object.assign({path:[]},O.data),P=(O.data.argumentList||[]).map(ee);let p;try{const d=i.slice(0,-1).reduce((S,w)=>S[w],r),y=i.reduce((S,w)=>S[w],r);switch(A){case"GET":p=y;break;case"SET":d[i.slice(-1)[0]]=ee(O.data.value),p=!0;break;case"APPLY":p=y.apply(d,P);break;case"CONSTRUCT":{const S=new y(...P);p=yt(S)}break;case"ENDPOINT":{const{port1:S,port2:w}=new MessageChannel;ge(r,w),p=ht(S,[S])}break;case"RELEASE":p=void 0;break;default:return}}catch(d){p={value:d,[fe]:0}}Promise.resolve(p).catch(d=>({value:d,[fe]:0})).then(d=>{const[y,S]=ye(d);o.postMessage(Object.assign(Object.assign({},y),{id:j}),S),A==="RELEASE"&&(o.removeEventListener("message",E),dt(o),pe in r&&typeof r[pe]=="function"&&r[pe]())}).catch(d=>{const[y,S]=ye({value:new TypeError("Unserializable return value"),[fe]:0});o.postMessage(Object.assign(Object.assign({},y),{id:j}),S)})}),o.start&&o.start()}function Ot(r){return r.constructor.name==="MessagePort"}function dt(r){Ot(r)&&r.close()}function pt(r,o){const a=new Map;return r.addEventListener("message",function(O){const{data:j}=O;if(!j||!j.id)return;const A=a.get(j.id);if(A)try{A(j)}finally{a.delete(j.id)}}),Se(r,a,[],o)}function ce(r){if(r)throw new Error("Proxy has been released and is not useable")}function ft(r){return ne(r,new Map,{type:"RELEASE"}).then(()=>{dt(r)})}const me=new WeakMap,he="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const o=(me.get(r)||0)-1;me.set(r,o),o===0&&ft(r)});function Tt(r,o){const a=(me.get(o)||0)+1;me.set(o,a),he&&he.register(r,o,r)}function It(r){he&&he.unregister(r)}function Se(r,o,a=[],E=function(){}){let O=!1;const j=new Proxy(E,{get(A,i){if(ce(O),i===ut)return()=>{It(j),ft(r),o.clear(),O=!0};if(i==="then"){if(a.length===0)return{then:()=>j};const P=ne(r,o,{type:"GET",path:a.map(p=>p.toString())}).then(ee);return P.then.bind(P)}return Se(r,o,[...a,i])},set(A,i,P){ce(O);const[p,d]=ye(P);return ne(r,o,{type:"SET",path:[...a,i].map(y=>y.toString()),value:p},d).then(ee)},apply(A,i,P){ce(O);const p=a[a.length-1];if(p===lt)return ne(r,o,{type:"ENDPOINT"}).then(ee);if(p==="bind")return Se(r,o,a.slice(0,-1));const[d,y]=rt(P);return ne(r,o,{type:"APPLY",path:a.map(S=>S.toString()),argumentList:d},y).then(ee)},construct(A,i){ce(O);const[P,p]=rt(i);return ne(r,o,{type:"CONSTRUCT",path:a.map(d=>d.toString()),argumentList:P},p).then(ee)}});return Tt(j,r),j}function Nt(r){return Array.prototype.concat.apply([],r)}function rt(r){const o=r.map(ye);return[o.map(a=>a[0]),Nt(o.map(a=>a[1]))]}const mt=new WeakMap;function ht(r,o){return mt.set(r,o),r}function yt(r){return Object.assign(r,{[xe]:!0})}function At(r,o=globalThis,a="*"){return{postMessage:(E,O)=>r.postMessage(E,a,O),addEventListener:o.addEventListener.bind(o),removeEventListener:o.removeEventListener.bind(o)}}function ye(r){for(const[o,a]of Oe)if(a.canHandle(r)){const[E,O]=a.serialize(r);return[{type:"HANDLER",name:o,value:E},O]}return[{type:"RAW",value:r},mt.get(r)||[]]}function ee(r){switch(r.type){case"HANDLER":return Oe.get(r.name).deserialize(r.value);case"RAW":return r.value}}function ne(r,o,a,E){return new Promise(O=>{const j=Rt();o.set(j,O),r.start&&r.start(),r.postMessage(Object.assign({id:j},a),E)})}function Rt(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Mt=Object.freeze({__proto__:null,createEndpoint:lt,expose:ge,finalizer:pe,proxy:yt,proxyMarker:xe,releaseProxy:ut,transfer:ht,transferHandlers:Oe,windowEndpoint:At,wrap:pt}),ke=(r=>(r.Start="start",r.End="end",r.Input="input",r.Output="output",r.Sleep="sleep",r.Error="error",r.Interrupt="interrupt",r.Loading="loading",r.Frame="frame",r.FrameChange="frame-change",r.Stop="stop",r))(ke||{});function Dt(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var o=r.default;if(typeof o=="function"){var a=function E(){var O=!1;try{O=this instanceof E}catch{}return O?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};a.prototype=o.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(r).forEach(function(E){var O=Object.getOwnPropertyDescriptor(r,E);Object.defineProperty(a,E,O.get?O:{enumerable:!0,get:function(){return r[E]}})}),a}var ve={exports:{}},be={exports:{}},nt;function Ft(){return nt||(nt=1,(function(r,o){(function(a,E){r.exports=E()})(self,(function(){return(()=>{var a={d:(c,h)=>{for(var m in h)a.o(h,m)&&!a.o(c,m)&&Object.defineProperty(c,m,{enumerable:!0,get:h[m]})},o:(c,h)=>Object.prototype.hasOwnProperty.call(c,h),r:c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}},E={};a.r(E),a.d(E,{isServiceWorkerRequest:()=>i,serviceWorkerFetchListener:()=>P,asyncSleep:()=>p,ServiceWorkerError:()=>d,writeMessageAtomics:()=>y,writeMessageServiceWorker:()=>S,writeMessage:()=>w,makeChannel:()=>x,makeAtomicsChannel:()=>L,makeServiceWorkerChannel:()=>D,readMessage:()=>M,syncSleep:()=>q,uuidv4:()=>Y});var O=function(c,h,m,T){return new(m||(m=Promise))((function(F,I){function W(_){try{g(T.next(_))}catch(b){I(b)}}function k(_){try{g(T.throw(_))}catch(b){I(b)}}function g(_){var b;_.done?F(_.value):(b=_.value,b instanceof m?b:new m((function(N){N(b)}))).then(W,k)}g((T=T.apply(c,[])).next())}))};const j="__SyncMessageServiceWorkerInput__",A="__sync-message-v2__";function i(c){return typeof c!="string"&&(c=c.request.url),c.includes(j)}function P(){const c={},h={};return m=>{const{url:T}=m.request;return!!i(T)&&(m.respondWith((function(){return O(this,void 0,void 0,(function*(){function F(I){const W={message:I,version:A};return new Response(JSON.stringify(W),{status:200})}if(T.endsWith("/read")){const{messageId:I,timeout:W}=yield m.request.json();if(I in c){const k=c[I];return delete c[I],F(k)}return yield new Promise((k=>{h[I]=k,setTimeout((function(){delete h[I],k(new Response("",{status:408}))}),W)}))}if(T.endsWith("/write")){const{message:I,messageId:W}=yield m.request.json(),k=h[W];return k?(k(F(I)),delete h[W]):c[W]=I,F({early:!k})}if(T.endsWith("/version"))return new Response(A,{status:200})}))})()),!0)}}function p(c){return new Promise((h=>setTimeout(h,c)))}class d extends Error{constructor(h,m){super(`Received status ${m} from ${h}. Ensure the service worker is registered and active.`),this.url=h,this.status=m,this.type="ServiceWorkerError",Object.setPrototypeOf(this,d.prototype)}}function y(c,h){const m=new TextEncoder().encode(JSON.stringify(h)),{data:T,meta:F}=c;if(m.length>T.length)throw new Error("Message is too big, increase bufferSize when making channel.");T.set(m,0),Atomics.store(F,0,m.length),Atomics.store(F,1,1),Atomics.notify(F,1)}function S(c,h,m){return O(this,void 0,void 0,(function*(){yield navigator.serviceWorker.ready;const T=c.baseUrl+"/write",F=Date.now();for(;;){const I={message:h,messageId:m},W=yield fetch(T,{method:"POST",body:JSON.stringify(I)});if(W.status===200&&(yield W.json()).version===A)return;if(!(Date.now()-F<c.timeout))throw new d(T,W.status);yield p(100)}}))}function w(c,h,m){return O(this,void 0,void 0,(function*(){c.type==="atomics"?y(c,h):yield S(c,h,m)}))}function x(c={}){return typeof SharedArrayBuffer<"u"?L(c.atomics):"serviceWorker"in navigator?D(c.serviceWorker):null}function L({bufferSize:c}={}){return{type:"atomics",data:new Uint8Array(new SharedArrayBuffer(c||131072)),meta:new Int32Array(new SharedArrayBuffer(2*Int32Array.BYTES_PER_ELEMENT))}}function D(c={}){return{type:"serviceWorker",baseUrl:(c.scope||"/")+j,timeout:c.timeout||5e3}}function v(c,h){return c>0?+c:h}function M(c,h,{checkInterrupt:m,checkTimeout:T,timeout:F}={}){const I=performance.now();T=v(T,m?100:5e3);const W=v(F,Number.POSITIVE_INFINITY);let k;if(c.type==="atomics"){const{data:g,meta:_}=c;k=()=>{if(Atomics.wait(_,1,0,T)==="timed-out")return null;{const b=Atomics.exchange(_,0,0),N=g.slice(0,b);Atomics.store(_,1,0);const $=new TextDecoder().decode(N);return JSON.parse($)}}}else k=()=>{const g=new XMLHttpRequest,_=c.baseUrl+"/read";g.open("POST",_,!1);const b={messageId:h,timeout:T};g.send(JSON.stringify(b));const{status:N}=g;if(N===408)return null;if(N===200){const $=JSON.parse(g.responseText);return $.version!==A?null:$.message}if(performance.now()-I<c.timeout)return null;throw new d(_,N)};for(;;){const g=W-(performance.now()-I);if(g<=0)return null;T=Math.min(T,g);const _=k();if(_!==null)return _;if(m?.())return null}}function q(c,h){if(c=v(c,0))if(typeof SharedArrayBuffer<"u"){const m=new Int32Array(new SharedArrayBuffer(Int32Array.BYTES_PER_ELEMENT));m[0]=0,Atomics.wait(m,0,0,c)}else M(h,`sleep ${c} ${Y()}`,{timeout:c})}let Y;return Y="randomUUID"in crypto?function(){return crypto.randomUUID()}:function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(c=>{const h=Number(c);return(h^crypto.getRandomValues(new Uint8Array(1))[0]&15>>h/4).toString(16)}))},E})()}))})(be)),be.exports}var gt=Dt(Mt),it;function wt(){return it||(it=1,(function(r,o){(function(a,E){r.exports=E(Ft(),gt)})(self,(function(a,E){return(()=>{var O={272:P=>{P.exports=E},746:P=>{P.exports=a}},j={};function A(P){var p=j[P];if(p!==void 0)return p.exports;var d=j[P]={exports:{}};return O[P](d,d.exports,A),d.exports}A.n=P=>{var p=P&&P.__esModule?()=>P.default:()=>P;return A.d(p,{a:p}),p},A.d=(P,p)=>{for(var d in p)A.o(p,d)&&!A.o(P,d)&&Object.defineProperty(P,d,{enumerable:!0,get:p[d]})},A.o=(P,p)=>Object.prototype.hasOwnProperty.call(P,p),A.r=P=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(P,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(P,"__esModule",{value:!0})};var i={};return(()=>{A.r(i),A.d(i,{InterruptError:()=>y,NoChannelError:()=>S,SyncClient:()=>w,syncExpose:()=>x});var P=A(746),p=A(272),d=function(D,v,M,q){return new(M||(M=Promise))((function(Y,c){function h(F){try{T(q.next(F))}catch(I){c(I)}}function m(F){try{T(q.throw(F))}catch(I){c(I)}}function T(F){var I;F.done?Y(F.value):(I=F.value,I instanceof M?I:new M((function(W){W(I)}))).then(h,m)}T((q=q.apply(D,[])).next())}))};class y extends Error{constructor(){super(...arguments),this.type="InterruptError",this.name=this.type}}class S extends Error{constructor(){super(...arguments),this.type="NoChannelError",this.name=this.type}}class w{constructor(v,M){this.workerCreator=v,this.channel=M,this.state="idle",this._messageIdBase="",this._messageIdSeq=0,this._start()}interrupt(){return d(this,void 0,void 0,(function*(){this.state!=="idle"&&(this.state!=="awaitingMessage"&&this.state!=="sleeping"?this.interrupter?yield this.interrupter():(this.terminate(),this._start()):yield this._writeMessage({interrupted:!0}))}))}call(v,...M){return d(this,void 0,void 0,(function*(){if(this.state!=="idle")throw new Error(`State is ${this.state}, not idle`);let q=!0;this.state="running",this._messageIdBase=(0,P.uuidv4)(),this._messageIdSeq=0;const Y=c=>{var h;q&&c!=="init"&&(c==="reading"?(this.state="awaitingMessage",this._messageIdSeq++,(h=this._awaitingMessageResolve)===null||h===void 0||h.call(this)):c==="sleeping"?(this.state="sleeping",this._messageIdSeq++):c==="slept"&&(this.state="running"))};this._interruptPromise=new Promise(((c,h)=>this._interruptRejector=h));try{return yield Promise.race([v(this.channel,p.proxy(Y),this._messageIdBase,...M),this._interruptPromise])}finally{q=!1,this._reset()}}))}writeMessage(v){return d(this,void 0,void 0,(function*(){if(this.state==="idle"||!this._messageIdBase)throw new Error("No active call to send a message to.");if(this.state!=="awaitingMessage"){if(this._awaitingMessageResolve)throw new Error("Not waiting for message, and another write is already queued.");yield new Promise((M=>{this._awaitingMessageResolve=M})),delete this._awaitingMessageResolve}yield this._writeMessage({message:v})}))}terminate(){var v;(v=this._interruptRejector)===null||v===void 0||v.call(this,new y("Worker terminated")),this.workerProxy[p.releaseProxy](),this.worker.terminate(),delete this.workerProxy,delete this.worker}_writeMessage(v){return d(this,void 0,void 0,(function*(){this.state="running";const M=L(this._messageIdBase,this._messageIdSeq);yield(0,P.writeMessage)(this.channel,v,M)}))}_start(){this._reset(),this.worker=this.workerCreator(),this.workerProxy=p.wrap(this.worker)}_reset(){this.state="idle",delete this._interruptPromise,delete this._interruptRejector,delete this._awaitingMessageResolve,delete this._messageIdBase}}function x(D){return function(v,M,q,...Y){return d(this,void 0,void 0,(function*(){yield M("init");let c=0;function h(m,T){if(!v)throw new S;M(m);const F=L(q,++c),I=(0,P.readMessage)(v,F,T);if(I){const{message:W,interrupted:k}=I;if(k)throw new y;return W}m==="sleeping"&&M("slept")}return D({channel:v,readMessage:()=>h("reading"),syncSleep(m){m>0&&h("sleeping",{timeout:m})}},...Y)}))}}function L(D,v){return`${D}-${v}`}})(),i})()}))})(ve)),ve.exports}var Lt=wt();class Ct{constructor(o,a=100){this.callback=o,this.flushTime=a,this.queue=[],this.lastFlushTime=new Date().getTime(),this.decoder=new TextDecoder}put(o,a,E){let O="";typeof a=="number"?O=a.toString():typeof a!="string"?O=this.decoder.decode(a):O=a;let j={},A="text/plain";E&&(typeof E=="string"?A=E:(A=E.contentType,delete E.contentType,j=E)),this.queue.length===0||!A.startsWith("text")||this.queue[this.queue.length-1].type!==o||this.queue[this.queue.length-1].contentType!==A?this.queue.push({type:o,data:O,contentType:A,...j}):this.queue[this.queue.length-1].data+=O,this.shouldFlush()&&this.flush()}shouldFlush(){return this.queue.length>1||new Date().getTime()-this.lastFlushTime>this.flushTime}reset(){this.queue=[],this.lastFlushTime=new Date().getTime()}flush(){this.queue.forEach(o=>{this.callback(o)}),this.queue=[],this.lastFlushTime=new Date().getTime()}setCallback(o){this.callback=o}}var Pe=(r=>(r.Run="run",r.Debug="debug",r.Doctest="doctest",r))(Pe||{});class jt{constructor(){this.extras={},this.onEvent=()=>{},this.runCode=this.syncExpose()(this.runCode.bind(this)),this.queue={}}syncExpose(){return Lt.syncExpose}async launch(o){return this.onEvent=a=>{if(o(a),a.type===ke.Sleep)return this.extras.syncSleep(a.data);if(a.type===ke.Input)return this.extras.readMessage()},this.queue=new Ct(this.onEvent.bind(this)),Promise.resolve()}runModes(o){return[]}provideFiles(o,a){return Promise.resolve()}}var Ee={exports:{}};function re(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var de={exports:{}},ot;function Ut(){return ot||(ot=1,(function(r,o){var a=(()=>{var E=Object.defineProperty,O=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,A=Object.prototype.hasOwnProperty,i=(e,t)=>E(e,"name",{value:t,configurable:!0}),P=(e=>typeof re<"u"?re:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof re<"u"?re:t)[n]}):e)(function(e){if(typeof re<"u")return re.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),p=(e,t)=>{for(var n in t)E(e,n,{get:t[n],enumerable:!0})},d=(e,t,n,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of j(t))!A.call(e,s)&&s!==n&&E(e,s,{get:()=>t[s],enumerable:!(l=O(t,s))||l.enumerable});return e},y=e=>d(E({},"__esModule",{value:!0}),e),S=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var l=n.length,s=new Uint8Array((l-(n[l-1]=="=")-(n[l-2]=="="))*3/4|0),u=0,f=0;u<l;){var R=e[n.charCodeAt(u++)],C=e[n.charCodeAt(u++)],U=e[n.charCodeAt(u++)],B=e[n.charCodeAt(u++)];s[f++]=R<<2|C>>4,s[f++]=C<<4|U>>2,s[f++]=U<<6|B}return s}})(),w={};p(w,{loadPyodide:()=>_e,version:()=>ue});function x(e){return!isNaN(parseFloat(e))&&isFinite(e)}i(x,"_isNumber");function L(e){return e.charAt(0).toUpperCase()+e.substring(1)}i(L,"_capitalize");function D(e){return function(){return this[e]}}i(D,"_getter");var v=["isConstructor","isEval","isNative","isToplevel"],M=["columnNumber","lineNumber"],q=["fileName","functionName","source"],Y=["args"],c=["evalOrigin"],h=v.concat(M,q,Y,c);function m(e){if(e)for(var t=0;t<h.length;t++)e[h[t]]!==void 0&&this["set"+L(h[t])](e[h[t]])}for(i(m,"StackFrame"),m.prototype={getArgs:i(function(){return this.args},"getArgs"),setArgs:i(function(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=e},"setArgs"),getEvalOrigin:i(function(){return this.evalOrigin},"getEvalOrigin"),setEvalOrigin:i(function(e){if(e instanceof m)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new m(e);else throw new TypeError("Eval Origin must be an Object or StackFrame")},"setEvalOrigin"),toString:i(function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",l=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:l?l+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n},"toString")},m.fromString=i(function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),l=e.substring(0,t),s=e.substring(t+1,n).split(","),u=e.substring(n+1);if(u.indexOf("@")===0)var f=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(u,""),R=f[1],C=f[2],U=f[3];return new m({functionName:l,args:s||void 0,fileName:R,lineNumber:C||void 0,columnNumber:U||void 0})},"StackFrame$$fromString"),T=0;T<v.length;T++)m.prototype["get"+L(v[T])]=D(v[T]),m.prototype["set"+L(v[T])]=(function(e){return function(t){this[e]=!!t}})(v[T]);var T;for(F=0;F<M.length;F++)m.prototype["get"+L(M[F])]=D(M[F]),m.prototype["set"+L(M[F])]=(function(e){return function(t){if(!x(t))throw new TypeError(e+" must be a Number");this[e]=Number(t)}})(M[F]);var F;for(I=0;I<q.length;I++)m.prototype["get"+L(q[I])]=D(q[I]),m.prototype["set"+L(q[I])]=(function(e){return function(t){this[e]=String(t)}})(q[I]);var I,W=m;function k(){var e=/^\s*at .*(\S+:\d+|\(native\))/m,t=/^(eval@)?(\[native code])?$/;return{parse:i(function(n){if(n.stack&&n.stack.match(e))return this.parseV8OrIE(n);if(n.stack)return this.parseFFOrSafari(n);throw new Error("Cannot parse given Error object")},"ErrorStackParser$$parse"),extractLocation:i(function(n){if(n.indexOf(":")===-1)return[n];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,s=l.exec(n.replace(/[()]/g,""));return[s[1],s[2]||void 0,s[3]||void 0]},"ErrorStackParser$$extractLocation"),parseV8OrIE:i(function(n){var l=n.stack.split(`
`).filter(function(s){return!!s.match(e)},this);return l.map(function(s){s.indexOf("(eval ")>-1&&(s=s.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var u=s.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),f=u.match(/ (\(.+\)$)/);u=f?u.replace(f[0],""):u;var R=this.extractLocation(f?f[1]:u),C=f&&u||void 0,U=["eval","<anonymous>"].indexOf(R[0])>-1?void 0:R[0];return new W({functionName:C,fileName:U,lineNumber:R[1],columnNumber:R[2],source:s})},this)},"ErrorStackParser$$parseV8OrIE"),parseFFOrSafari:i(function(n){var l=n.stack.split(`
`).filter(function(s){return!s.match(t)},this);return l.map(function(s){if(s.indexOf(" > eval")>-1&&(s=s.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),s.indexOf("@")===-1&&s.indexOf(":")===-1)return new W({functionName:s});var u=/((.*".+"[^@]*)?[^@]*)(?:@)/,f=s.match(u),R=f&&f[1]?f[1]:void 0,C=this.extractLocation(s.replace(u,""));return new W({functionName:R,fileName:C[0],lineNumber:C[1],columnNumber:C[2],source:s})},this)},"ErrorStackParser$$parseFFOrSafari")}}i(k,"ErrorStackParser");var g=new k,_=g;function b(){if(typeof API<"u"&&API!==globalThis.API)return API.runtimeEnv;let e=typeof Bun<"u",t=typeof Deno<"u",n=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!process.browser,l=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Safari")>-1;return $({IN_BUN:e,IN_DENO:t,IN_NODE:n,IN_SAFARI:l,IN_SHELL:typeof read=="function"&&typeof load=="function"})}i(b,"getGlobalRuntimeEnv");var N=b();function $(e){let t=e.IN_NODE&&!0&&r.exports&&typeof P=="function"&&typeof __dirname=="string",n=e.IN_NODE&&!t,l=!e.IN_NODE&&!e.IN_DENO&&!e.IN_BUN,s=l&&typeof window<"u"&&typeof window.document<"u"&&typeof document.createElement=="function"&&"sessionStorage"in window&&typeof globalThis.importScripts!="function",u=l&&typeof globalThis.WorkerGlobalScope<"u"&&typeof globalThis.self<"u"&&globalThis.self instanceof globalThis.WorkerGlobalScope;return{...e,IN_BROWSER:l,IN_BROWSER_MAIN_THREAD:s,IN_BROWSER_WEB_WORKER:u,IN_NODE_COMMONJS:t,IN_NODE_ESM:n}}i($,"calculateDerivedFlags");var Z,z,V,H,J;async function Q(){if(!N.IN_NODE||(Z=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,H=await import("./__vite-browser-external-9wXp6ZBx.js"),J=await import("./__vite-browser-external-9wXp6ZBx.js"),V=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,z=await import("./__vite-browser-external-9wXp6ZBx.js"),we=z.sep,typeof P<"u"))return;let e=H,t=await import("./__vite-browser-external-9wXp6ZBx.js"),n=await import("./__vite-browser-external-9wXp6ZBx.js"),l=await import("./__vite-browser-external-9wXp6ZBx.js"),s={fs:e,crypto:t,ws:n,child_process:l};globalThis.require=function(u){return s[u]}}i(Q,"initNodeModules");function Te(e,t){return z.resolve(t||".",e)}i(Te,"node_resolvePath");function Ie(e,t){return t===void 0&&(t=location),new URL(e,t).toString()}i(Ie,"browser_resolvePath");var ie;N.IN_NODE?ie=Te:N.IN_SHELL?ie=i(e=>e,"resolvePath"):ie=Ie;var we;N.IN_NODE||(we="/");function Ne(e,t){return e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?{response:fetch(e)}:{binary:J.readFile(e).then(n=>new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}i(Ne,"node_getBinaryResponse");function Ae(e,t){if(e.startsWith("file://")&&(e=e.slice(7)),e.includes("://"))throw new Error("Shell cannot fetch urls");return{binary:Promise.resolve(new Uint8Array(readbuffer(e)))}}i(Ae,"shell_getBinaryResponse");function Re(e,t){let n=new URL(e,location);return{response:fetch(n,t?{integrity:t}:{})}}i(Re,"browser_getBinaryResponse");var oe;N.IN_NODE?oe=Ne:N.IN_SHELL?oe=Ae:oe=Re;async function Me(e,t){let{response:n,binary:l}=oe(e,t);if(l)return l;let s=await n;if(!s.ok)throw new Error(`Failed to load '${e}': request failed.`);return new Uint8Array(await s.arrayBuffer())}i(Me,"loadBinaryFile");var ae;if(N.IN_BROWSER_MAIN_THREAD)ae=i(async e=>await import(e),"loadScript");else if(N.IN_BROWSER_WEB_WORKER)ae=i(async e=>{try{globalThis.importScripts(e)}catch(t){if(t instanceof TypeError)await import(e);else throw t}},"loadScript");else if(N.IN_NODE)ae=De;else if(N.IN_SHELL)ae=load;else throw new Error("Cannot determine runtime environment");async function De(e){e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?V.runInThisContext(await(await fetch(e)).text()):await import(Z.pathToFileURL(e).href)}i(De,"nodeLoadScript");async function Fe(e){if(N.IN_NODE){await Q();let t=await J.readFile(e,{encoding:"utf8"});return JSON.parse(t)}else if(N.IN_SHELL){let t=read(e);return JSON.parse(t)}else return await(await fetch(e)).json()}i(Fe,"loadLockFile");async function Le(){if(N.IN_NODE_COMMONJS)return __dirname;let e;try{throw new Error}catch(l){e=l}let t=_.parse(e)[0].fileName;if(N.IN_NODE&&!t.startsWith("file://")&&(t=`file://${t}`),N.IN_NODE_ESM){let l=await import("./__vite-browser-external-9wXp6ZBx.js");return(await import("./__vite-browser-external-9wXp6ZBx.js")).fileURLToPath(l.dirname(t))}let n=t.lastIndexOf(we);if(n===-1)throw new Error("Could not extract indexURL path from pyodide module location. Please pass the indexURL explicitly to loadPyodide.");return t.slice(0,n)}i(Le,"calculateDirname");function Ce(e){return e.substring(0,e.lastIndexOf("/")+1)||globalThis.location?.toString()||"."}i(Ce,"calculateInstallBaseUrl");function je(e){let t=e.FS,n=e.FS.filesystems.MEMFS,l=e.PATH,s={DIR_MODE:16895,FILE_MODE:33279,mount:i(function(u){if(!u.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return n.mount.apply(null,arguments)},"mount"),syncfs:i(async(u,f,R)=>{try{let C=s.getLocalSet(u),U=await s.getRemoteSet(u),B=f?U:C,K=f?C:U;await s.reconcile(u,B,K),R(null)}catch(C){R(C)}},"syncfs"),getLocalSet:i(u=>{let f=Object.create(null);function R(B){return B!=="."&&B!==".."}i(R,"isRealDir");function C(B){return K=>l.join2(B,K)}i(C,"toAbsolute");let U=t.readdir(u.mountpoint).filter(R).map(C(u.mountpoint));for(;U.length;){let B=U.pop(),K=t.stat(B);t.isDir(K.mode)&&U.push.apply(U,t.readdir(B).filter(R).map(C(B))),f[B]={timestamp:K.mtime,mode:K.mode}}return{type:"local",entries:f}},"getLocalSet"),getRemoteSet:i(async u=>{let f=Object.create(null),R=await _t(u.opts.fileSystemHandle);for(let[C,U]of R)C!=="."&&(f[l.join2(u.mountpoint,C)]={timestamp:U.kind==="file"?new Date((await U.getFile()).lastModified):new Date,mode:U.kind==="file"?s.FILE_MODE:s.DIR_MODE});return{type:"remote",entries:f,handles:R}},"getRemoteSet"),loadLocalEntry:i(u=>{let f=t.lookupPath(u,{}).node,R=t.stat(u);if(t.isDir(R.mode))return{timestamp:R.mtime,mode:R.mode};if(t.isFile(R.mode))return f.contents=n.getFileDataAsTypedArray(f),{timestamp:R.mtime,mode:R.mode,contents:f.contents};throw new Error("node type not supported")},"loadLocalEntry"),storeLocalEntry:i((u,f)=>{if(t.isDir(f.mode))t.mkdirTree(u,f.mode);else if(t.isFile(f.mode))t.writeFile(u,f.contents,{canOwn:!0});else throw new Error("node type not supported");t.chmod(u,f.mode),t.utime(u,f.timestamp,f.timestamp)},"storeLocalEntry"),removeLocalEntry:i(u=>{var f=t.stat(u);t.isDir(f.mode)?t.rmdir(u):t.isFile(f.mode)&&t.unlink(u)},"removeLocalEntry"),loadRemoteEntry:i(async u=>{if(u.kind==="file"){let f=await u.getFile();return{contents:new Uint8Array(await f.arrayBuffer()),mode:s.FILE_MODE,timestamp:new Date(f.lastModified)}}else{if(u.kind==="directory")return{mode:s.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+u.kind)}},"loadRemoteEntry"),storeRemoteEntry:i(async(u,f,R)=>{let C=u.get(l.dirname(f)),U=t.isFile(R.mode)?await C.getFileHandle(l.basename(f),{create:!0}):await C.getDirectoryHandle(l.basename(f),{create:!0});if(U.kind==="file"){let B=await U.createWritable();await B.write(R.contents),await B.close()}u.set(f,U)},"storeRemoteEntry"),removeRemoteEntry:i(async(u,f)=>{await u.get(l.dirname(f)).removeEntry(l.basename(f)),u.delete(f)},"removeRemoteEntry"),reconcile:i(async(u,f,R)=>{let C=0,U=[];Object.keys(f.entries).forEach(function(G){let X=f.entries[G],te=R.entries[G];(!te||t.isFile(X.mode)&&X.timestamp.getTime()>te.timestamp.getTime())&&(U.push(G),C++)}),U.sort();let B=[];if(Object.keys(R.entries).forEach(function(G){f.entries[G]||(B.push(G),C++)}),B.sort().reverse(),!C)return;let K=f.type==="remote"?f.handles:R.handles;for(let G of U){let X=l.normalize(G.replace(u.mountpoint,"/")).substring(1);if(R.type==="local"){let te=K.get(X),St=await s.loadRemoteEntry(te);s.storeLocalEntry(G,St)}else{let te=s.loadLocalEntry(G);await s.storeRemoteEntry(K,X,te)}}for(let G of B)if(R.type==="local")s.removeLocalEntry(G);else{let X=l.normalize(G.replace(u.mountpoint,"/")).substring(1);await s.removeRemoteEntry(K,X)}},"reconcile")};e.FS.filesystems.NATIVEFS_ASYNC=s}i(je,"initializeNativeFS");var _t=i(async e=>{let t=[];async function n(s){for await(let u of s.values())t.push(u),u.kind==="directory"&&await n(u)}i(n,"collect"),await n(e);let l=new Map;l.set(".",e);for(let s of t){let u=(await e.resolve(s)).join("/");l.set(u,s)}return l},"getFsHandles"),vt=S("AGFzbQEAAAABDANfAGAAAW9gAW8BfwMDAgECByECD2NyZWF0ZV9zZW50aW5lbAAAC2lzX3NlbnRpbmVsAAEKEwIHAPsBAPsbCwkAIAD7GvsUAAs="),bt=(async function(){if(!(globalThis.navigator&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&typeof navigator.maxTouchPoints<"u"&&navigator.maxTouchPoints>1)))try{let e=await WebAssembly.compile(vt);return await WebAssembly.instantiate(e)}catch(e){if(e instanceof WebAssembly.CompileError)return;throw e}})();async function Ue(){let e=await bt;if(e)return e.exports;let t=Symbol("error marker");return{create_sentinel:i(()=>t,"create_sentinel"),is_sentinel:i(n=>n===t,"is_sentinel")}}i(Ue,"getSentinelImport");function qe(e){let t={config:e,runtimeEnv:N},n={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:Ve(e),print:e.stdout,printErr:e.stderr,onExit(l){n.exitCode=l},thisProgram:e._sysExecutable,arguments:e.args,API:t,locateFile:i(l=>e.indexURL+l,"locateFile"),instantiateWasm:Je(e.indexURL)};return n}i(qe,"createSettings");function We(e){return function(t){let n="/";try{t.FS.mkdirTree(e)}catch(l){console.error(`Error occurred while making a home directory '${e}':`),console.error(l),console.error(`Using '${n}' for a home directory instead`),e=n}t.FS.chdir(e)}}i(We,"createHomeDirectory");function $e(e){return function(t){Object.assign(t.ENV,e)}}i($e,"setEnvironment");function Be(e){return e?[async t=>{t.addRunDependency("fsInitHook");try{await e(t.FS,{sitePackages:t.API.sitePackages})}finally{t.removeRunDependency("fsInitHook")}}]:[]}i(Be,"callFsInitHook");function ze(e){let t=e.HEAPU32[e._Py_Version>>>2],n=t>>>24&255,l=t>>>16&255,s=t>>>8&255;return[n,l,s]}i(ze,"computeVersionTuple");function He(e){let t=Me(e);return async n=>{n.API.pyVersionTuple=ze(n);let[l,s]=n.API.pyVersionTuple;n.FS.mkdirTree("/lib"),n.API.sitePackages=`/lib/python${l}.${s}/site-packages`,n.FS.mkdirTree(n.API.sitePackages),n.addRunDependency("install-stdlib");try{let u=await t;n.FS.writeFile(`/lib/python${l}${s}.zip`,u)}catch(u){console.error("Error occurred while installing the standard library:"),console.error(u)}finally{n.removeRunDependency("install-stdlib")}}}i(He,"installStdlib");function Ve(e){let t;return e.stdLibURL!=null?t=e.stdLibURL:t=e.indexURL+"python_stdlib.zip",[He(t),We(e.env.HOME),$e(e.env),je,...Be(e.fsInit)]}i(Ve,"getFileSystemInitializationFuncs");function Je(e){if(typeof WasmOffsetConverter<"u")return;let{binary:t,response:n}=oe(e+"pyodide.asm.wasm"),l=Ue();return function(s,u){return(async function(){s.sentinel=await l;try{let f;n?f=await WebAssembly.instantiateStreaming(n,s):f=await WebAssembly.instantiate(await t,s);let{instance:R,module:C}=f;u(R,C)}catch(f){console.warn("wasm instantiation failed!"),console.warn(f)}})(),{}}}i(Je,"getInstantiateWasmFunc");var Et="0.29.3";function se(e){return e===void 0||e.endsWith("/")?e:e+"/"}i(se,"withTrailingSlash");var ue=Et;async function Ye(e={}){if(await Q(),e.lockFileContents&&e.lockFileURL)throw new Error("Can't pass both lockFileContents and lockFileURL");let t=e.indexURL||await Le();if(t=se(ie(t)),e.packageBaseUrl=se(e.packageBaseUrl),e.cdnUrl=se(e.packageBaseUrl??`https://cdn.jsdelivr.net/pyodide/v${ue}/full/`),!e.lockFileContents){let s=e.lockFileURL??t+"pyodide-lock.json";e.lockFileContents=Fe(s),e.packageBaseUrl??=Ce(s)}e.indexURL=t,e.packageCacheDir&&(e.packageCacheDir=se(ie(e.packageCacheDir)));let n={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?()=>globalThis.prompt():void 0,args:[],env:{},packages:[],packageCacheDir:e.packageBaseUrl,enableRunUntilComplete:!0,checkAPIVersion:!0,BUILD_ID:"b7b7b0f46eb68e65c029c0dc739270e8a5d35251e9aab6014ee1c2f630e5d1d0"},l=Object.assign(n,e);return l.env.HOME??="/home/pyodide",l.env.PYTHONINSPECT??="1",l}i(Ye,"initializeConfiguration");function Ge(e){let t=qe(e),n=t.API;return n.lockFilePromise=Promise.resolve(e.lockFileContents),t}i(Ge,"createEmscriptenSettings");async function Ke(e){if(typeof _createPyodideModule!="function"){let t=`${e.indexURL}pyodide.asm.js`;await ae(t)}}i(Ke,"loadWasmScript");async function Ze(e,t){if(!e._loadSnapshot)return;let n=await e._loadSnapshot,l=ArrayBuffer.isView(n)?n:new Uint8Array(n);return t.noInitialRun=!0,t.INITIAL_MEMORY=l.length,l}i(Ze,"prepareSnapshot");async function Qe(e){let t=await _createPyodideModule(e);if(e.exitCode!==void 0)throw new t.ExitStatus(e.exitCode);return t}i(Qe,"createPyodideModule");function Xe(e,t){let n=e.API;if(t.pyproxyToStringRepr&&n.setPyProxyToStringMethod(!0),t.convertNullToNone&&n.setCompatNullToNone(!0),t.toJsLiteralMap&&n.setCompatToJsLiteralMap(!0),n.version!==ue&&t.checkAPIVersion)throw new Error(`Pyodide version does not match: '${ue}' <==> '${n.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);e.locateFile=l=>{throw l.endsWith(".so")?new Error(`Failed to find dynamic library "${l}"`):new Error(`Unexpected call to locateFile("${l}")`)}}i(Xe,"configureAPI");function et(e,t,n){let l=e.API,s;return t&&(s=l.restoreSnapshot(t)),l.finalizeBootstrap(s,n._snapshotDeserializer)}i(et,"bootstrapPyodide");async function tt(e,t){let n=e._api;return n.sys.path.insert(0,""),n._pyodide.set_excepthook(),await n.packageIndexReady,n.initializeStreams(t.stdin,t.stdout,t.stderr),e}i(tt,"finalizeSetup");async function _e(e={}){let t=await Ye(e),n=Ge(t);await Ke(t);let l=await Ze(t,n),s=await Qe(n);Xe(s,t);let u=et(s,l,t);return await tt(u,t)}return i(_e,"loadPyodide"),globalThis.loadPyodide=_e,y(w)})();try{Object.assign(o,a)}catch{}globalThis.loadPyodide=a.loadPyodide})(de,de.exports)),de.exports}var at;function qt(){return at||(at=1,(function(r,o){(function(a,E){r.exports=E(wt(),gt,Ut())})(self,((a,E,O)=>(()=>{var j={237:(p,d,y)=>{y.d(d,{Z:()=>S});const S=`import importlib
import sys
from typing import Callable, Literal, Union, TypedDict

try:
    from pyodide.code import find_imports  # noqa
except ImportError:
    from pyodide import find_imports  # noqa

import pyodide_js  # noqa

sys.setrecursionlimit(400)


class InstallEntry(TypedDict):
    module: str
    package: str


def find_imports_to_install(imports: list[str]) -> list[InstallEntry]:
    """
    Given a list of module names being imported, return a list of dicts
    representing the packages that need to be installed to import those modules.
    The returned list will only contain modules that aren't already installed.
    Each returned dict has the following keys:
      - module: the name of the module being imported
      - package: the name of the package that needs to be installed
    """
    try:
        to_package_name = pyodide_js._module._import_name_to_package_name.to_py()
    except AttributeError:
        to_package_name = pyodide_js._api._import_name_to_package_name.to_py()

    to_install: list[InstallEntry] = []
    for module in imports:
        try:
            importlib.import_module(module)
        except ModuleNotFoundError:
            to_install.append(
                dict(
                    module=module,
                    package=to_package_name.get(module, module),
                )
            )
    return to_install


async def install_imports(
    source_code_or_imports: Union[str, list[str]],
    message_callback: Callable[
        [
            Literal[
                "loading_all",
                "loaded_all",
                "loading_one",
                "loaded_one",
                "loading_micropip",
                "loaded_micropip",
            ],
            Union[InstallEntry, list[InstallEntry]],
        ],
        None,
    ] = lambda event_type, data: None,
):
    """
    Accepts a string of Python source code or a list of module names being imported.
    Installs any packages that need to be installed to import those modules,
    using micropip, which may also be installed if needed.
    If the package is not specially built for Pyodide, it must be available on PyPI
    as a pure Python wheel file.
    If the \`message_callback\` argument is provided, it will be called with an
    event type and data about the packages being installed.
    The event types start with \`loading_\` before installation, and \`loaded_\` after.
    The data is either a single dict representing the package being installed,
    or a list of all the packages being installed.
    The events are:
        - loading/loaded_all, with a list of all the packages being installed.
        - loading/loaded_one, with a dict for a single package.
        - loading/loaded_micropip, with a dict for the special micropip package.
    """
    if isinstance(source_code_or_imports, str):
        try:
            imports: list[str] = find_imports(source_code_or_imports)
        except SyntaxError:
            return
    else:
        imports: list[str] = source_code_or_imports

    to_install = find_imports_to_install(imports)
    if to_install:
        message_callback("loading_all", to_install)
        try:
            import micropip  # noqa
        except ModuleNotFoundError:
            micropip_entry = dict(module="micropip", package="micropip")
            message_callback("loading_micropip", micropip_entry)
            await pyodide_js.loadPackage("micropip")
            import micropip  # noqa

            message_callback("loaded_micropip", micropip_entry)

        for entry in to_install:
            message_callback("loading_one", entry)
            await micropip.install(entry["package"])
            message_callback("loaded_one", entry)
        message_callback("loaded_all", to_install)
`},353:(p,d,y)=>{p.exports=y(846)},846:(p,d,y)=>{var S=y(960);d.operation=function(w){var x=d.timeouts(w);return new S(x,{forever:w&&(w.forever||w.retries===1/0),unref:w&&w.unref,maxRetryTime:w&&w.maxRetryTime})},d.timeouts=function(w){if(w instanceof Array)return[].concat(w);var x={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var L in w)x[L]=w[L];if(x.minTimeout>x.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var D=[],v=0;v<x.retries;v++)D.push(this.createTimeout(v,x));return w&&w.forever&&!D.length&&D.push(this.createTimeout(v,x)),D.sort((function(M,q){return M-q})),D},d.createTimeout=function(w,x){var L=x.randomize?Math.random()+1:1,D=Math.round(L*Math.max(x.minTimeout,1)*Math.pow(x.factor,w));return Math.min(D,x.maxTimeout)},d.wrap=function(w,x,L){if(x instanceof Array&&(L=x,x=null),!L)for(var D in L=[],w)typeof w[D]=="function"&&L.push(D);for(var v=0;v<L.length;v++){var M=L[v],q=w[M];w[M]=(function(Y){var c=d.operation(x),h=Array.prototype.slice.call(arguments,1),m=h.pop();h.push((function(T){c.retry(T)||(T&&(arguments[0]=c.mainError()),m.apply(this,arguments))})),c.attempt((function(){Y.apply(w,h)}))}).bind(w,q),w[M].options=x}}},960:p=>{function d(y,S){typeof S=="boolean"&&(S={forever:S}),this._originalTimeouts=JSON.parse(JSON.stringify(y)),this._timeouts=y,this._options=S||{},this._maxRetryTime=S&&S.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}p.exports=d,d.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},d.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},d.prototype.retry=function(y){if(this._timeout&&clearTimeout(this._timeout),!y)return!1;var S=new Date().getTime();if(y&&S-this._operationStart>=this._maxRetryTime)return this._errors.push(y),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(y);var w=this._timeouts.shift();if(w===void 0){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),w=this._cachedTimeouts.slice(-1)}var x=this;return this._timer=setTimeout((function(){x._attempts++,x._operationTimeoutCb&&(x._timeout=setTimeout((function(){x._operationTimeoutCb(x._attempts)}),x._operationTimeout),x._options.unref&&x._timeout.unref()),x._fn(x._attempts)}),w),this._options.unref&&this._timer.unref(),!0},d.prototype.attempt=function(y,S){this._fn=y,S&&(S.timeout&&(this._operationTimeout=S.timeout),S.cb&&(this._operationTimeoutCb=S.cb));var w=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){w._operationTimeoutCb()}),w._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},d.prototype.try=function(y){console.log("Using RetryOperation.try() is deprecated"),this.attempt(y)},d.prototype.start=function(y){console.log("Using RetryOperation.start() is deprecated"),this.attempt(y)},d.prototype.start=d.prototype.try,d.prototype.errors=function(){return this._errors},d.prototype.attempts=function(){return this._attempts},d.prototype.mainError=function(){if(this._errors.length===0)return null;for(var y={},S=null,w=0,x=0;x<this._errors.length;x++){var L=this._errors[x],D=L.message,v=(y[D]||0)+1;y[D]=v,v>=w&&(S=L,w=v)}return S}},272:p=>{p.exports=E},422:p=>{p.exports=a},28:p=>{p.exports=O}},A={};function i(p){var d=A[p];if(d!==void 0)return d.exports;var y=A[p]={exports:{}};return j[p](y,y.exports,i),y.exports}i.d=(p,d)=>{for(var y in d)i.o(d,y)&&!i.o(p,y)&&Object.defineProperty(p,y,{enumerable:!0,get:d[y]})},i.o=(p,d)=>Object.prototype.hasOwnProperty.call(p,d),i.r=p=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})};var P={};return(()=>{i.r(P),i.d(P,{PyodideClient:()=>I,PyodideFatalErrorReloader:()=>W,defaultPyodideLoader:()=>q,initPyodide:()=>h,loadPyodideAndPackage:()=>c,makeRunnerCallback:()=>T,pyodideExpose:()=>F,versionInfo:()=>Y});var p=i(353);const d=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"]);class y extends Error{constructor(g){super(),g instanceof Error?(this.originalError=g,{message:g}=g):(this.originalError=new Error(g),this.originalError.stack=this.stack),this.name="AbortError",this.message=g}}const S=k=>globalThis.DOMException===void 0?new Error(k):new DOMException(k);async function w(k,g){return new Promise(((_,b)=>{g={onFailedAttempt(){},retries:10,...g};const N=p.operation(g);N.attempt((async $=>{try{_(await k($))}catch(z){if(!(z instanceof Error))return void b(new TypeError(`Non-error was thrown: "${z}". You should only throw errors.`));if(z instanceof y)N.stop(),b(z.originalError);else if(z instanceof TypeError&&(Z=z.message,!d.has(Z)))N.stop(),b(z);else{((V,H,J)=>{const Q=J.retries-(H-1);V.attemptNumber=H,V.retriesLeft=Q})(z,$,g);try{await g.onFailedAttempt(z)}catch(V){return void b(V)}N.retry(z)||b(N.mainError())}}var Z})),g.signal&&!g.signal.aborted&&g.signal.addEventListener("abort",(()=>{N.stop();const $=g.signal.reason===void 0?S("The operation was aborted."):g.signal.reason;b($ instanceof Error?$:S($))}),{once:!0})}))}var x=i(422),L=i(272),D=i(28),v=function(k,g,_,b){return new(_||(_=Promise))((function(N,$){function Z(H){try{V(b.next(H))}catch(J){$(J)}}function z(H){try{V(b.throw(H))}catch(J){$(J)}}function V(H){var J;H.done?N(H.value):(J=H.value,J instanceof _?J:new _((function(Q){Q(J)}))).then(Z,z)}V((b=b.apply(k,[])).next())}))};const M=i(237).Z;function q(k=D.version){return v(this,void 0,void 0,(function*(){const g=`https://cdn.jsdelivr.net/pyodide/v${k}/full/`,_=yield(0,D.loadPyodide)({indexURL:g});if(_.version!==k)throw new Error(`loadPyodide loaded version ${_.version} instead of ${k}`);return _}))}function Y(k){return k.split(".").map(Number)}function c(k,g=q){return v(this,void 0,void 0,(function*(){let _,b,{format:N,extractDir:$,url:Z}=k;$=$||"/tmp/",[_,b]=yield Promise.all([w((()=>g()),{retries:3}),w((()=>(function(V){return v(this,void 0,void 0,(function*(){if(m.has(V))return console.log("Loaded package from cache"),m.get(V);console.log("Fetching package from "+V.slice(0,100)+"...");const H=yield fetch(V);if(!H.ok)throw new Error(`Request for package failed with status ${H.status}: ${H.statusText}`);const J=yield H.arrayBuffer();return console.log("Fetched package"),m.set(V,J),J}))})(Z)),{retries:3})]);const z=Y(_.version);return _.unpackArchive(b,N,z[0]===0&&z[1]<=19?$:{extractDir:$}),_.pyimport("sys").path.append($),h(_),_}))}function h(k){k.registerComlink(L);const g=k.pyimport("sys"),_=k.pyimport("pathlib"),b="/tmp/pyodide_worker_runner/";g.path.append(b),_.Path(b).mkdir(),_.Path(b+"pyodide_worker_runner.py").write_text(M),k.pyimport("pyodide_worker_runner")}const m=new Map;function T(k,g){return function(_,b){return b.toJs&&(b=b.toJs({dict_converter:Object.fromEntries})),_==="input"?(g.input&&g.input(b.prompt),k.readMessage()+`
`):_!=="sleep"?_==="output"?g.output(b.parts):g.other(_,b):void k.syncSleep(1e3*b.seconds)}}function F(k){return(0,x.syncExpose)((function(g,_,...b){return v(this,void 0,void 0,(function*(){return k(Object.assign(Object.assign({},g),{interruptBuffer:_}),...b)}))}))}class I extends x.SyncClient{call(g,..._){const b=Object.create(null,{call:{get:()=>super.call}});return v(this,void 0,void 0,(function*(){let N=null;return typeof SharedArrayBuffer<"u"&&(N=new Int32Array(new SharedArrayBuffer(1*Int32Array.BYTES_PER_ELEMENT)),this.interrupter=()=>{N[0]=2}),b.call.call(this,g,N,..._)}))}}class W{constructor(g){this.loader=g,this.pyodidePromise=g()}withPyodide(g){return v(this,void 0,void 0,(function*(){const _=yield this.pyodidePromise;try{return yield g(_)}catch(b){throw b.pyodide_fatal_error&&(this.pyodidePromise=this.loader()),b}}))}}})(),P})()))})(Ee)),Ee.exports}var st=qt();const Wt=new URL("/assets/python_package.tar.gz-C_Q0QjxY.load_by_url",import.meta.url).href;class le extends jt{constructor(){super(),this.pyodide={},this.installPromise=null}static convert(o){return o.toJs?o.toJs({dict_converter:Object.fromEntries}):o}syncExpose(){return st.pyodideExpose}static async getPyodide(){return await st.loadPyodideAndPackage({url:Wt,format:".tgz"})}async launch(o){await super.launch(o),this.pyodide=await le.getPyodide(),this.papyros=this.pyodide.pyimport("papyros").Papyros.callKwargs({callback:a=>{const E=le.convert(a);return this.onEvent(E)},buffer_constructor:a=>(this.queue.setCallback(a),this.queue)}),await this.pyodide.loadPackage("micropip")}async installImports(o){this.installPromise==null&&(this.installPromise=this.papyros?.install_imports.callKwargs({source_code:o,ignore_missing:!0})),await this.installPromise,this.installPromise=null}runModes(o){let a=super.runModes(o);return this.papyros?.has_doctests(o)&&(a=[Pe.Doctest,...a]),a=[Pe.Debug,...a],a}async runCode(o,a,E="exec"){return this.extras=o,o.interruptBuffer&&this.pyodide.setInterruptBuffer(o.interruptBuffer),await this.installImports(a),await this.papyros?.run_async.callKwargs({source_code:a,mode:E})}async lintCode(o){return await this.installImports(o),le.convert(this.papyros?.lint(o)||[])}async provideFiles(o,a){await this.papyros?.provide_files.callKwargs({inline_files:JSON.stringify(o),href_files:JSON.stringify(a)})}}const $t=new le;ge($t);
